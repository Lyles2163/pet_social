import{s as A,N as b,Q as O,H,ab as p,h as a,F as E,i as V,a8 as M,_ as Q,am as U,ar as j,c as T,n as L,an as q,ap as m,k as u,l as G,r as y,f as J,b as K,al as R,o as _,a as P,t as x}from"./index-DPCorpo5.js";import{T as B,E as W}from"./index-D0HrV6Mm.js";import{I as C}from"./index-C7ZXWBde.js";const[X,r]=H("card"),Y={tag:String,num:b,desc:String,thumb:String,title:String,price:b,centered:Boolean,lazyLoad:Boolean,currency:O("¥"),thumbLink:String,originPrice:b};var Z=A({name:X,props:Y,emits:["clickThumb"],setup(n,{slots:e,emit:s}){const t=()=>{if(e.title)return e.title();if(n.title)return a("div",{class:[r("title"),"van-multi-ellipsis--l2"]},[n.title])},g=()=>{if(e.tag||n.tag)return a("div",{class:r("tag")},[e.tag?e.tag():a(B,{mark:!0,type:"primary"},{default:()=>[n.tag]})])},v=()=>e.thumb?e.thumb():a(C,{src:n.thumb,fit:"cover",width:"100%",height:"100%",lazyLoad:n.lazyLoad},null),d=()=>{if(e.thumb||n.thumb)return a("a",{href:n.thumbLink,class:r("thumb"),onClick:o=>s("clickThumb",o)},[v(),g()])},c=()=>{if(e.desc)return e.desc();if(n.desc)return a("div",{class:[r("desc"),"van-ellipsis"]},[n.desc])},l=()=>{const o=n.price.toString().split(".");return a("div",null,[a("span",{class:r("price-currency")},[n.currency]),a("span",{class:r("price-integer")},[o[0]]),o.length>1&&a(E,null,[V("."),a("span",{class:r("price-decimal")},[o[1]])])])};return()=>{var o,f,h;const i=e.num||p(n.num),w=e.price||p(n.price),k=e["origin-price"]||p(n.originPrice),N=i||w||k||e.bottom,I=w&&a("div",{class:r("price")},[e.price?e.price():l()]),S=k&&a("div",{class:r("origin-price")},[e["origin-price"]?e["origin-price"]():`${n.currency} ${n.originPrice}`]),z=i&&a("div",{class:r("num")},[e.num?e.num():`x${n.num}`]),D=e.footer&&a("div",{class:r("footer")},[e.footer()]),F=N&&a("div",{class:r("bottom")},[(o=e["price-top"])==null?void 0:o.call(e),I,S,z,(f=e.bottom)==null?void 0:f.call(e)]);return a("div",{class:r()},[a("div",{class:r("header")},[d(),a("div",{class:r("content",{centered:n.centered})},[a("div",null,[t(),c(),(h=e.tags)==null?void 0:h.call(e)]),F])]),D])}}});const $=M(Z),ee={components:{VanList:j,VanCard:$,VanImage:C,VanTag:B,VanNavBar:U,VanEmpty:W},setup(){const n=y([]),e=y(!1),s=y(!1),t=c=>c===1?"男孩":"女孩",g=c=>{c.target.src="default-avatar.png"},v=async()=>{e.value=!0;try{const{data:c}=await K.get("http://localhost:3000/api/pets",{withCredentials:!0});n.value=c.map(l=>({...l,avatar:l.avatar||"default-avatar.png"})),s.value=!0}catch(c){console.error("加载宠物信息失败:",c),R("加载宠物信息失败"),s.value=!0}finally{e.value=!1}},d=()=>{s.value||v()};return J(()=>{d()}),{pets:n,genderText:t,loading:e,finished:s,onLoad:d,handleImageError:g}}},ae={class:"cute-pet-container"},ne={class:"owner-info"};function te(n,e,s,t,g,v){const d=m("van-nav-bar"),c=m("van-image"),l=m("van-tag"),o=m("van-card"),f=m("van-list"),h=m("van-empty");return _(),T("div",ae,[a(d,{title:"可爱宠物列表","left-arrow":"",onClickLeft:e[0]||(e[0]=i=>n.$router.back())}),a(f,{loading:t.loading,"onUpdate:loading":e[1]||(e[1]=i=>t.loading=i),finished:t.finished,"finished-text":"没有更多了",onLoad:t.onLoad,offset:"300"},{default:u(()=>[(_(!0),T(E,null,G(t.pets,i=>(_(),L(o,{key:i.id,title:i.name,desc:`品种：${i.species} | 年龄：${i.age}岁`,class:"pet-card"},{thumb:u(()=>[a(c,{width:"80",height:"80",fit:"cover",src:i.avatar||"default-avatar.png",onError:t.handleImageError,class:"pet-avatar"},null,8,["src","onError"])]),tags:u(()=>[a(l,{type:"primary",class:"gender-tag"},{default:u(()=>[V(x(t.genderText(i.gender)),1)]),_:2},1024)]),footer:u(()=>[P("div",ne,[a(c,{width:"25",height:"25",round:"",src:i.owner_avatar||"default-avatar.png",onError:t.handleImageError},null,8,["src","onError"]),P("span",null,"主人："+x(i.username),1)])]),_:2},1032,["title","desc"]))),128))]),_:1},8,["loading","finished","onLoad"]),!t.loading&&t.finished&&t.pets.length===0?(_(),L(h,{key:0,description:"暂无宠物信息"})):q("",!0)])}const oe=Q(ee,[["render",te],["__scopeId","data-v-2c6619de"]]);export{oe as default};
